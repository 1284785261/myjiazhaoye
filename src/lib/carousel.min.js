/*slider无缝滚动*/
$(function () {
    $.fn.thumbnailImg = function (options) {
        var defaluts = {
            large_elem: "large_elem",
            small_elem: "small_elem",
            left_btn: "left_btn",
            right_btn: "right_btn",
            state: "on",
            speed: "normal",
            vis: 3
        };
        var opts = $.extend({}, defaluts, options);
            this.each(function () {
            var $this = $(this);
            var Small_pic = $this.find(opts.small_elem);
            var Large_pic = $this.find(opts.large_elem);
            Large_pic.find("ul li").eq(0).show();
            Small_pic.find("ul li").eq(0).addClass(opts.state);
            var l = Small_pic.find("ul li").length;
            //console.log(l);
            var l_mean;
            if (l < opts.vis) {
                l_mean = 0
            } else {
                l_mean = ((parseInt(l / opts.vis) - 1) * opts.vis) + (l % opts.vis)
            }
            var w = Small_pic.find("ul li").outerWidth(true);
            Small_pic.find("ul").css("width", l * w + "px");
            Small_pic.find("ul li").click(function () {
                $(this).addClass(opts.state).siblings().removeClass(opts.state);
                Img($(this).index())
            });
            $(opts.left_btn).click(function () {
                var i;
                Small_pic.find("ul li").each(function (index) {
                    if ($(this).hasClass(opts.state)) {
                        i = index
                    }
                });
                i--;
                if (i < 0) {
                    i = l - 1
                }
                Small_pic.find("ul li").eq(i).addClass(opts.state).siblings().removeClass(opts.state);
                var ml = i * w;
                if (ml <= l_mean * w) {
                    Small_pic.find("ul").stop().animate({marginLeft: -ml + "px"}, opts.speed)
                } else {
                    Small_pic.find("ul").stop().animate({marginLeft: -(l_mean * w) + "px"}, opts.speed)
                }
                Img(i)
            });
            $(opts.right_btn).click(function () {
                var i;
                Small_pic.find("ul li").each(function (index) {
                    if ($(this).hasClass(opts.state)) {
                        i = index
                    }
                });
                i++;
                if (i > l - 1) {
                    i = 0
                }
                Small_pic.find("ul li").eq(i).addClass(opts.state).siblings().removeClass(opts.state);
                var ml = i * w;
                if (ml <= l_mean * w) {
                    Small_pic.find("ul").stop().animate({marginLeft: -ml + "px"}, opts.speed)
                } else {
                    Small_pic.find("ul").stop().animate({marginLeft: -(l_mean * w) + "px"}, opts.speed)
                }
                Img(i)
            });
            function Img(i) {
                Large_pic.find("ul li").eq(i).fadeIn().siblings().hide()
            };
        })
    }
});